(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[5],{103:function(e,t,n){},104:function(e,t,n){"use strict";n.r(t);var r,c,a,u,i=n(0),o=n.n(i),s=n(26),l=n.n(s),d=n(20),j=n(10),b=n(48),f=n(6),p={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name},getUserEmail:function(e){return e.auth.user.email},getError:function(e){return e.auth.error},getIsFetchingCurrentUser:function(e){return e.auth.isFetchingCurrentUser}},h=n(19),O=n.n(h),g=n(1),v=function(){var e=Object(j.c)(p.getIsLoggedIn);return Object(g.jsxs)("nav",{children:[Object(g.jsx)(d.c,{exact:!0,to:"/",className:O.a.link,activeClassName:O.a.activeLink,children:"Main"}),e&&Object(g.jsx)(d.c,{exact:!0,to:"/contacts",className:O.a.link,activeClassName:O.a.activeLink,children:"Contacts"})]})},x=n(9),m=n(34),k=n.n(m),C=function(){var e=Object(j.b)(),t=Object(j.c)(p.getUserName);return Object(g.jsxs)("div",{className:k.a.container,children:[Object(g.jsxs)("p",{className:k.a.greatings,children:["Welcome, ",t,"!"]}),Object(g.jsx)("button",{className:k.a.logOutButton,type:"button",onClick:function(){return e(x.a.logOut())},children:"Log out"})]})},y=function(){return Object(g.jsxs)("div",{children:[Object(g.jsx)(d.c,{exact:!0,to:"/register",className:O.a.link,activeClassName:O.a.activeLink,children:"Register"}),Object(g.jsx)(d.c,{exact:!0,to:"/login",className:O.a.link,activeClassName:O.a.activeLink,children:"Login"})]})},w=function(){var e=Object(j.c)(p.getIsLoggedIn);return Object(g.jsxs)("header",{className:O.a.sidebar,children:[Object(g.jsx)(v,{}),e?Object(g.jsx)(C,{}):Object(g.jsx)(y,{})]})},I=(n(81),n(50)),L=n.n(I),U=n(22),_=n(23),N=n(33),F=["redirectTo","children"],T=function(e){var t=e.redirectTo,n=e.children,r=Object(N.a)(e,F),c=Object(j.c)(p.getIsLoggedIn);return Object(g.jsx)(f.b,Object(_.a)(Object(_.a)({},r),{},{children:c?n:Object(g.jsx)(f.a,{to:t})}))},z=["redirectTo","children"],W=function(e){var t=e.redirectTo,n=e.children,r=Object(N.a)(e,z),c=Object(j.c)(p.getIsLoggedIn)&&r.restricted;return Object(g.jsx)(f.b,Object(_.a)(Object(_.a)({},r),{},{children:c?Object(g.jsx)(f.a,{to:t}):n}))},B=Object(i.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,201))})),S=Object(i.lazy)((function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,202))})),E=Object(i.lazy)((function(){return n.e(1).then(n.bind(null,199))})),V=Object(i.lazy)((function(){return n.e(2).then(n.bind(null,197))})),M=function(){var e=Object(j.c)(p.getIsFetchingCurrentUser),t=Object(j.b)();return Object(i.useEffect)((function(){t(x.a.fetchCurrentUser())}),[t]),!e&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(w,{}),Object(g.jsx)(f.d,{children:Object(g.jsxs)(i.Suspense,{fallback:Object(g.jsx)(L.a,{type:"ThreeDots",color:"#3f51b5",height:280,width:280}),children:[Object(g.jsx)(W,{exact:!0,path:"/",children:Object(g.jsx)(V,{})}),Object(g.jsx)(W,{exact:!0,path:U.a.register,restricted:!0,redirectTo:U.a.contacts,children:Object(g.jsx)(B,{})}),Object(g.jsx)(W,{exact:!0,path:U.a.login,restricted:!0,redirectTo:U.a.contacts,children:Object(g.jsx)(S,{})}),Object(g.jsx)(T,{exact:!0,path:U.a.contacts,redirectTo:U.a.login,children:Object(g.jsx)(E,{})})]})})]})},R=n(32),A=n(7),P=n(21),G=n(51),J=n.n(G),Z=n(2),q=n(12),D=n(8),Y=n(31),H=Object(A.d)([],(r={},Object(Z.a)(r,D.fetchContacts.fulfilled,(function(e,t){return t.payload})),Object(Z.a)(r,D.addContact.fulfilled,(function(e,t){return[t.payload].concat(Object(R.a)(e))})),Object(Z.a)(r,D.deleteContact.fulfilled,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),r)),K=Object(A.d)(!1,(c={},Object(Z.a)(c,D.fetchContacts.pending,(function(){return!0})),Object(Z.a)(c,D.fetchContacts.fulfilled,(function(){return!1})),Object(Z.a)(c,D.fetchContacts.rejected,(function(){return!1})),Object(Z.a)(c,D.deleteContact.pending,(function(){return!0})),Object(Z.a)(c,D.deleteContact.fulfilled,(function(){return!1})),Object(Z.a)(c,D.deleteContact.rejected,(function(){return!1})),Object(Z.a)(c,D.addContact.pending,(function(){return!0})),Object(Z.a)(c,D.addContact.fulfilled,(function(){return!1})),Object(Z.a)(c,D.addContact.rejected,(function(){return!1})),c)),Q=Object(A.d)(null,(a={},Object(Z.a)(a,D.fetchContacts.rejected,(function(e,t){return t.payload})),Object(Z.a)(a,D.fetchContacts.pending,(function(){return null})),Object(Z.a)(a,D.deleteContact.rejected,(function(e,t){return t.payload})),Object(Z.a)(a,D.deleteContact.pending,(function(){return null})),Object(Z.a)(a,D.addContact.rejected,(function(e,t){return t.payload})),Object(Z.a)(a,D.addContact.pending,(function(){return null})),a)),X=Object(A.d)("",Object(Z.a)({},Y.a,(function(e,t){return t.payload}))),$=Object(q.b)({entities:H,filter:X,isLoading:K,error:Q}),ee=Object(A.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,error:null,isFetchingCurrentUser:!1},extraReducers:(u={},Object(Z.a)(u,x.a.register.pending,(function(e,t){e.error=null})),Object(Z.a)(u,x.a.register.fulfilled,(function(e,t){var n=t.payload;e.user=n.user,e.token=n.token,e.isLoggedIn=!0})),Object(Z.a)(u,x.a.register.rejected,(function(e,t){var n=t.payload;e.error=n})),Object(Z.a)(u,x.a.logIn.pending,(function(e,t){e.error=null})),Object(Z.a)(u,x.a.logIn.fulfilled,(function(e,t){var n=t.payload;e.user=n.user,e.token=n.token,e.isLoggedIn=!0})),Object(Z.a)(u,x.a.logIn.rejected,(function(e,t){var n=t.payload;e.error=n})),Object(Z.a)(u,x.a.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(Z.a)(u,x.a.fetchCurrentUser.pending,(function(e,t){e.isFetchingCurrentUser=!0})),Object(Z.a)(u,x.a.fetchCurrentUser.fulfilled,(function(e,t){var n=t.payload;e.user=n,e.isLoggedIn=!0,e.isFetchingCurrentUser=!1})),Object(Z.a)(u,x.a.fetchCurrentUser.rejected,(function(e,t){e.isFetchingCurrentUser=!1})),u)}).reducer,te=Object(R.a)(Object(A.f)({serializableCheck:{ignoredActions:[P.a,P.f,P.b,P.c,P.d,P.e]}})),ne={key:"auth",storage:J.a,whitelist:["token"]},re=Object(A.a)({reducer:{auth:Object(P.g)(ne,ee),phoneBook:$},middleware:te,devTools:!1}),ce=Object(P.h)(re);n(102),n(103);l.a.render(Object(g.jsx)(o.a.StrictMode,{children:Object(g.jsx)(j.a,{store:re,children:Object(g.jsx)(b.PersistGate,{loading:null,persistor:ce,children:Object(g.jsx)(d.a,{children:Object(g.jsx)(M,{})})})})}),document.getElementById("root"))},19:function(e,t,n){e.exports={sidebar:"Sidebar_sidebar__2WupE",link:"Sidebar_link__t3vmZ",activeLink:"Sidebar_activeLink__1lvgz"}},22:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={contacts:"/contacts",login:"/login",register:"/register"}},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),c=Object(r.b)("phoneBook/changeFilter")},34:function(e,t,n){e.exports={container:"UserMenu_container__GgYhE",greatings:"UserMenu_greatings__38gFq",logOutButton:"UserMenu_logOutButton__1o0Zp"}},8:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchContacts",(function(){return h})),n.d(t,"deleteContact",(function(){return O})),n.d(t,"addContact",(function(){return g})),n.d(t,"changeFilter",(function(){return v}));var r=n(4),c=n.n(r),a=n(13),u=n(7),i=n(18),o=n.n(i);function s(){return l.apply(this,arguments)}function l(){return(l=Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.get("/contacts");case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return j.apply(this,arguments)}function j(){return(j=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.post("/contacts",{name:t.name,number:t.number});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.delete("/contacts/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p=n(31),h=Object(u.c)("contacts/fetchContacts",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,s();case 4:return a=e.sent,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),O=Object(u.c)("contacts/deleteContact",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,b(t);case 4:return e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()),g=Object(u.c)("contacts/addContact",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,a=t.number,u=n.rejectWithValue,e.prev=2,e.next=5,d({name:r,number:a});case 5:return i=e.sent,o=i.data,e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",u(e.t0));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}()),v=function(e){return function(t){t(p.a(e))}}},81:function(e,t,n){},9:function(e,t,n){"use strict";var r=n(4),c=n.n(r),a=n(13),u=n(18),i=n.n(u),o=n(7);i.a.defaults.baseURL="https://connections-api.herokuapp.com/";var s=function(e){i.a.defaults.headers.common.Authorization="Bearer ".concat(e)},l=function(){i.a.defaults.headers.common.Authorization=""},d=Object(o.c)("auth/register",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("/users/signup",t);case 4:return a=e.sent,u=a.data,s(u.token),e.abrupt("return",u);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),j=Object(o.c)("auth/login",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("/users/login",t);case 4:return a=e.sent,u=a.data,s(u.token),e.abrupt("return",u);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),b={register:d,logOut:Object(o.c)("auth/logout",Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.post("/users/logout");case 3:l(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),logIn:j,fetchCurrentUser:Object(o.c)("auth/refresh",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState(),null!==(a=r.auth.token)){e.next=4;break}return e.abrupt("return",n.RejectWithValue());case 4:return s(a),e.prev=5,e.next=8,i.a.get("/users/current");case 8:return u=e.sent,o=u.data,e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(5);case 15:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}())};t.a=b}},[[104,6,7]]]);
//# sourceMappingURL=main.cad5be29.chunk.js.map